const regex=RegExp(/[\w\d]+\-[\w\d]+\-[\w\d]+\-[\w\d]+/g);async function premiumPurchaseClick(){$("#render-payment-button").html(""),document.getElementById("uidInput").value="",document.getElementById("purchaseModel-title").innerHTML="Premium Purchase",document.getElementById("purchaseModal-link").setAttribute("href","https://example.com"),hideDefault(),showPaypal(20,"Premium"),$("#purchaseModal").modal("show")}async function standardPurchaseClick(){$("#render-payment-button").html(""),document.getElementById("uidInput").value="",document.getElementById("purchaseModel-title").innerHTML="Standard Purchase",document.getElementById("purchaseModal-link").setAttribute("href","https://example.com"),hideDefault(),showPaypal(12,"Standard"),$("#purchaseModal").modal("show")}function showPaypal(amount,type){paypal.Buttons({createOrder:function(data,actions){const uidString=document.getElementById("uidInput").value;return regex.test(uidString)?(document.getElementById("modal-payment").style.display="none",document.getElementById("modal-progress").style.display="block",actions.order.create({application_context:{shipping_preference:"NO_SHIPPING"},purchase_units:[{amount:{value:amount}}]})):null},onApprove:function(data,actions){return actions.order.capture().then((function(details){if("INSTRUMENT_DECLINED"===details.error)return actions.restart();verifyPayment(details,type)}))},onCancel:function(data,action){hideDefault()},onError:function(err){"Error: Expected an order id to be passed"!=err?alert(err):showErrorToast("Invalid Unique Id")}}).render("#render-payment-button")}async function verifyPayment(details,type){const postUrl=`https://kaustubh-patange.herokuapp.com/xclipper/license?orderId=${details.purchase_units[0].payments.captures[0].id}&type=${type}&uid=${document.getElementById("uidInput").value}&sandbox=true`,options={url:postUrl,method:"POST"};try{const response=await promisifiedRequest(options),jObject=JSON.parse(response);document.getElementById("modal-progress").style.display="none","success"===jObject.status||"exist"===jObject.status?document.getElementById("modal-content-success").style.display="block":showErrorMessage(jObject.message)}catch{showErrorMessage("Developer Error")}}function hideDefault(){document.getElementById("modal-payment").style.display="block",document.getElementById("modal-progress").style.display="none",document.getElementById("modal-content-success").style.display="none",document.getElementById("modal-content-failed").style.display="none"}function showErrorMessage(data){document.getElementById("modal-progress").style.display="none",document.getElementById("modal-content-failed").style.display="block",document.getElementById("modal-content-text-subtitle").innerHTML=`Error: ${data}`}const promisifiedRequest=(options,data=null)=>new Promise((resolve,reject)=>{const xmlHttp=new XMLHttpRequest;xmlHttp.onreadystatechange=function(){if(4==xmlHttp.readyState)switch(xmlHttp.status){case 200:case 400:case 401:case 403:case 404:resolve(xmlHttp.responseText)}},xmlHttp.open(options.method,options.url,!0),options.hasOwnProperty("content_type")&&xmlHttp.setRequestHeader("content-type",options.content_type),options.hasOwnProperty("Authorization")&&xmlHttp.setRequestHeader("Authorization",options.Authorization),xmlHttp.send(data)});function showErrorToast(msg){const options={style:{main:{background:"#ff5733","font-family":"roboto mono"}},settings:{duration:2500}};iqwerty.toast.toast(msg,options)}